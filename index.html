<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
<title>HeroHUD ‚Ä¢ Upload ‚Üí Analyze ‚Üí Send</title>
<meta name="theme-color" content="#0b1b16" />
<style>
  :root{
    --bg-top:#0b1b16; --bg-bot:#06121a;
    --mintL:#9CFFE0; --mint:#34D1A0; --aqua:#2FB0E9; --teal:#0E8B67;
    --text:#E9FFF6; --textDim:rgba(233,255,246,.85);
    --glass:rgba(255,255,255,0.06); --stroke:rgba(156,255,224,0.28);
    --warn:#f6bf3a;
  }
  html,body{margin:0;height:100%;background:linear-gradient(180deg,var(--bg-top),var(--bg-bot));color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  *{box-sizing:border-box}
  .btn{appearance:none;border:1px solid var(--mint);background:var(--glass);color:var(--mintL);
    padding:.85rem 1.4rem;border-radius:999px;letter-spacing:.08em;text-transform:uppercase;font-weight:700;
    backdrop-filter:blur(6px);cursor:pointer;transition:box-shadow .2s,transform .1s,opacity .2s;
    box-shadow:0 0 16px rgba(156,255,224,.14);font-size:13px}
  .btn:hover{box-shadow:0 0 26px rgba(156,255,224,.45)}
  .pill{border:1px solid var(--stroke);background:var(--glass);color:var(--text);cursor:pointer;border-radius:999px;padding:.45rem .85rem;font-size:12px}
  .topbar{position:fixed;inset:0 0 auto 0;height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;background:rgba(0,0,0,.4);border-bottom:1px solid var(--stroke)}
  .brand{font-weight:900;letter-spacing:.08em;color:var(--mintL)}
  #preview{display:none;position:relative;width:min(94vw,980px);aspect-ratio:16/10;border-radius:16px;overflow:hidden;border:1px solid var(--stroke);margin:auto;box-shadow:0 0 24px rgba(156,255,224,.14)}
  #preview img{width:100%;height:100%;object-fit:cover}
  #edgeGlow{position:absolute;inset:0;border-radius:16px;pointer-events:none;opacity:0;box-shadow:0 0 28px rgba(156,255,224,.6),inset 0 0 18px rgba(14,139,103,.55);transition:opacity .25s}
  .glow-on #edgeGlow{opacity:1}
  #tips{position:relative;width:min(94vw,980px);min-height:14px;margin:auto;margin-top:10px}
  .tip{opacity:0;transform:translateY(8px);transition:all .5s cubic-bezier(.2,.9,.2,1);
    background:rgba(255,255,255,.06);border:1px solid var(--stroke);backdrop-filter:blur(8px);
    color:var(--text);padding:.55rem .75rem;border-radius:10px;margin:.35rem auto;max-width:92%}
  .tip.show{opacity:1;transform:translateY(0)}
  #voiceOrb{position:fixed;left:18px;bottom:80px;width:54px;height:54px;border-radius:999px;border:1px solid var(--mint);
    background:radial-gradient(circle at 60% 40%, rgba(156,255,224,.25), rgba(47,176,233,.12));
    box-shadow:0 0 16px rgba(156,255,224,.25);display:grid;place-items:center}
  #voiceOrb.idle{box-shadow:0 0 10px rgba(156,255,224,.2)}
  #voiceOrb.speaking{box-shadow:0 0 20px rgba(156,255,224,.45),0 0 28px rgba(47,176,233,.35)}
  #bootVeil{position:fixed;inset:0;background:#03100c;z-index:99;display:flex;align-items:center;justify-content:center;flex-direction:column;color:var(--mintL)}
  .footer{position:fixed;left:50%;transform:translateX(-50%);bottom:14px;font-size:12px;color:rgba(233,255,246,.7);letter-spacing:.12em;text-transform:uppercase}
</style>
</head>
<body>
  <div class="topbar">
    <div class="brand">HeroHUD</div>
    <div class="menu">
      <button class="pill" id="btnFull">Full Screen</button>
    </div>
  </div>

  <div id="bootVeil">
    <div id="bootMsg">Please give Jared time to wake up.<br>Server configuring ‚Ä¢ Backend live</div>
    <div id="dedication" style="margin-top:14px;opacity:0">Precision meets grit. Heart meets hustle. ‚Äî Dedicated to Addison</div>
    <button class="pill" id="wakeBtn" style="display:none;margin-top:12px">Tap to Wake</button>
  </div>

  <main style="padding-top:70px;text-align:center">
    <div class="btn-row">
      <button class="btn" id="btnUpload">‚¨Ü Upload Photo</button>
      <button class="btn" id="btnAnalyze">üîç Analyze</button>
    </div>
    <div id="preview"><img id="previewImg" alt="preview"/><div id="edgeGlow"></div></div>
    <div id="tips"></div>
  </main>

  <div id="voiceOrb" class="idle"></div>
  <div class="footer">Powered by Cardinal-Garage_MND Inc.</div>

<script>
(() => {
  const el = {
    btnUpload: document.querySelector("#btnUpload"),
    btnAnalyze: document.querySelector("#btnAnalyze"),
    preview: document.querySelector("#preview"),
    previewImg: document.querySelector("#previewImg"),
    edgeGlow: document.querySelector("#edgeGlow"),
    tips: document.querySelector("#tips"),
    voiceOrb: document.querySelector("#voiceOrb"),
    wakeBtn: document.querySelector("#wakeBtn"),
    bootVeil: document.querySelector("#bootVeil"),
    dedication: document.querySelector("#dedication")
  };

  const STATE = { audioEnabled:false, uploads:0 };
  const API="https://jared-hero2-backend.onrender.com";
  const PAYPAL_URL="https://www.paypal.com/ncp/payment/MVWW6VPEHJKKU";

  function wait(ms){return new Promise(r=>setTimeout(r,ms));}

  /* ======= SPEECH: Addie (female) + Jared (male) ======= */
  let activeUtter=null;
  window.speechSynthesis.onvoiceschanged=()=>window.speechSynthesis.getVoices();

  function pickVoice(preferFemale=true){
    const voices=window.speechSynthesis.getVoices();
    if(!voices.length)return null;
    const us=voices.filter(v=>v.lang.toLowerCase().includes("en-us"));
    const females=["Google US English","Samantha","Jenny","Aria","Amelia","Sara","Coral","Alloy","Nova"];
    const males=["Daniel","Alex","Matthew","Guy","Neural"];
    if(preferFemale){
      return us.find(v=>females.includes(v.name))||us.find(v=>/female|aria|samantha|jenny|coral/i.test(v.name))||us[0]||voices[0];
    }else{
      return us.find(v=>males.includes(v.name))||us.find(v=>/male|daniel|alex|guy/i.test(v.name))||us[0]||voices[0];
    }
  }

  function speak(text,{female=false,rate=1.0,pitch=1.0,onend}={}){
    if(!STATE.audioEnabled)return onend&&onend();
    stopSpeech();
    const u=new SpeechSynthesisUtterance(text);
    const v=pickVoice(female);
    if(v)u.voice=v;
    u.rate=rate;u.pitch=pitch;
    u.onend=()=>{activeUtter=null;el.voiceOrb.className='idle';onend&&onend();};
    u.onerror=u.onend;
    activeUtter=u;el.voiceOrb.className='speaking';
    window.speechSynthesis.speak(u);
  }
  function stopSpeech(){
    if(activeUtter){
      window.speechSynthesis.cancel();
      activeUtter=null;
      el.voiceOrb.className='idle';
    }
  }

  /* ======= BOOT SEQUENCE ======= */
  async function bootSequence(){
    await wait(2000);
    el.dedication.style.opacity=1;
    await wait(1000);
    el.wakeBtn.style.display="inline-block";
  }
  function addieIntro(){
    const intro="Welcome to Cardinal‚Äôs Garage. I‚Äôm Addie ‚Äî your personal sales coach. Upload a job photo, tap Analyze, and Jared will guide the technical side. I‚Äôll handle training and sales confidence. Ready when you are.";
    speak(intro,{female:true,rate:1.05,pitch:1.08});
  }
  el.wakeBtn.onclick=()=>{
    STATE.audioEnabled=true;
    el.bootVeil.style.display="none";
    addieIntro();
  };
  window.addEventListener("load",bootSequence);

  /* ======= FILE HANDLING ======= */
  const fileInput=document.createElement("input");
  fileInput.type="file"; fileInput.accept="image/*";
  el.btnUpload.onclick=()=>fileInput.click();
  fileInput.onchange=()=>{
    const f=fileInput.files[0];
    if(!f)return;
    const url=URL.createObjectURL(f);
    el.previewImg.src=url;
    el.preview.style.display="block";
    tip("Photo ready ‚Äî tap Analyze.");
  };

  /* ======= TIP ======= */
  function tip(text){
    const t=document.createElement("div");
    t.className="tip";
    t.textContent=text;
    el.tips.appendChild(t);
    requestAnimationFrame(()=>t.classList.add("show"));
  }
  function clearTips(){el.tips.innerHTML="";}

  /* ======= PAYWALL ======= */
  function canAnalyze(){ return STATE.uploads < 1; }
  function showPaywall(){
    stopSpeech();
    const overlay=document.createElement("div");
    overlay.style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.8);z-index:9999;";
    overlay.innerHTML=`
      <div style="background:#0f1916;border:1px solid var(--stroke);padding:1rem 1.5rem;border-radius:14px;text-align:center;max-width:480px;color:var(--text)">
        <h3 style="color:var(--mintL)">Access Limit Reached</h3>
        <p style="opacity:.85">You‚Äôve completed your free demo. Unlock <b>Access+</b> for unlimited analyses and exports.</p>
        <div style="margin-top:1rem">
          <a class="btn" style="margin:4px" href="${PAYPAL_URL}" target="_blank">Activate Access+</a>
          <button class="btn" id="pwClose">Close</button>
        </div>
      </div>`;
    document.body.appendChild(overlay);
    overlay.querySelector("#pwClose").onclick=()=>overlay.remove();
  }

  /* ======= ANALYZE ======= */
  el.btnAnalyze.onclick=async()=>{
    if(!el.previewImg.src){tip("Upload a photo first.");return;}
    if(!canAnalyze()){showPaywall();return;}

    clearTips();
    el.preview.classList.add("glow-on");
    speak("Analyzing photo, please wait...",{female:false,rate:0.95});

    try{
      const formData=new FormData();
      const blob=await fetch(el.previewImg.src).then(r=>r.blob());
      formData.append("file",blob,"upload.jpg");
      const res=await fetch(API+"/analyze-image",{method:"POST",body:formData});
      const data=await res.json();
      const summary=data.summary||"Analysis complete.";
      const rec=data.recommendation||"Standard prep and edging recommended.";
      tip(summary);
      tip(rec);
      speak(summary,{female:false,rate:0.98,pitch:1.0});
      STATE.uploads++;
      if(STATE.uploads===1){
        tip("‚úÖ Demo mode: 1 analysis completed. Upgrade to continue using HeroHUD.");
      }
    }catch(e){
      tip("Analysis failed. Please try again.");
    }finally{
      el.preview.classList.remove("glow-on");
    }
  };
})();
</script>
</body>
</html>




